# 日历 问题

1. 每个月有多少天？
```
- 1月，3月，5月，7月，8月，10月，12月，都是31天
- 2月平年是28天，闰年是29天
- 其他月份：4月，6月，9月，11月

//输入年份，获取这一年每个月的天数
function m_days(year) {
  return [31,28+is_leap(year),31,30,31,30,31,31,30,31,30,31]
}
```
2. 每个月的第一天是星期几?
```
function firstDay(date) {
  return new Date(date + '-01').getDay()
}
```
核心函数

3.判断闰年还是平年
```
function is_leap(year) {
  return year % 400 === 0  || year % 4 === 0 && year % 100 !== 0 ? true : false
}
```

4.获取某一年各月的天数
```
function m_days(year) {
  return [31,28+is_leap(year),31,30,31,30,31,31,30,31,30,31]
}
```
5.获取某年某月的第一天是星期几
```
function firstDay(date) {
  return new Date(date + '-01').getDay()
}

// 月 第一天对应周几 需要计算空格
calculateEmptyGrids(year, month) {
		const firstDayOfWeek = this.getFirstDayOfWeek(year, month);
		let empytGrids = [];
		if (firstDayOfWeek > 0) {
			for (let i = 0; i < firstDayOfWeek; i++) {
				empytGrids.push(i);
			}
			this.setData({
				hasEmptyGrid: true,
				empytGrids
			});
		} else {
			this.setData({
				hasEmptyGrid: false,
				empytGrids: []
			});
		}
	},
```
6.获取每个月的天数数组
```
function generateDays(date) {
  var year  = date.split('-')[0]
  var month = date.split('-')[1] - 1
  var arr = []
  //根据某年某月的第一天是星期几来填充空值
  for(let j = 0; j < firstDay(date); j++) {
    arr.push({value: '', num: ''})
  }
  for(let i = 0; i < m_days(year)[month]; i++) {
     let value = year + '-' + addZero(month+1) + '-' + addZero(i+1)
     arr.push({
         num: addZero(i+1),
         value: value,
    })
  }
  return arr
}
// 一位数添加 0
function addZero(num) {
  return num < 10 ? '0' + num : num
}

//获取当前日期
function getCurrentDate(date) {
  var today = new Date()
  var year  = today.getFullYear()
  var month = today.getMonth() + 1
  var day   = today.getDate()
  var week  = today.getDay()

  function getFullDate() {
    return year + '-' + addZero(month) + '-' + addZero(day)
  }

  function getYearMonth() {
    return year + '-' + addZero(month)
  }

  return {
    getFullDate,
    getYearMonth,
  }
}

// 转换显示 年月
function translateFormateDate(date) {
  var year  = date.split('-')[0]
  var month = date.split('-')[1]
  return year + '年' + month + '月'
}

```

```
根据具体日期计算是一年的第几周：

[html] view plain copy print?
<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8">  
  <title>Document</title>  
</head>  
<body>  
  <script>  
    // 计算具体日期为当月的第几周  
    function getWeek(str) {  
      // 将字符串转为标准时间格式  
      str = Date.parse(str);  
      str = new Date(str);  
      // 先计算出该日期为第几周  
      let week = Math.ceil(str.getDate()/7);  
      let month = str.getMonth() + 1;  
      // 判断这个月前7天是周几，如果不是周一，则计入上个月  
      if  (str.getDate() < 7) {  
        if (str.getDay() !== 1) {  
          week = 5;  
          month = str.getMonth();  
        }  
      }  
      console.log(`${month}-${week}`);  
    }  
    console.log(getWeek('2017-01-01'));  
  </script>  
</body>  
</html>  

根据具体日期计算是当月的第几周：

[html] view plain copy print?
<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8">  
  <title>Document</title>  
</head>  
<body>  
  <script>  
    const year = String(new Date(Date.parse(date)).getFullYear());  
    console.log('year:', year);  
    console.log('date:', new Date(year));  
    const week =  (((new Date(date)) - (new Date(year))) / (24 * 60 * 60 * 7 * 1000) | 0) + 1;  
    console.log('week', week);  
  </script>  
</body>  
</html>  
```

项目地址：https://github.com/wardenger/wx-calendar 
